(()=>{"use strict";var e={574:function(e,n,t){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getIdOfAcName=n.getNameOfAcId=n.analyzeField=n.analyzeForm=n.generateMatchingItem=void 0;const i=a(t(37)),r=t(579),o=a(t(643));n.generateMatchingItem=(e,n,t)=>{var a,i;const r={};r.formId=t,r.formHeadings=d(n,t),r.inputType=e.type,r.inputName=e.name,r.fieldType=e.tagName.toLowerCase();const o=[...n.getElementsByTagName("label")].filter((n=>n.htmlFor==e.id));return console.log(o),console.log(null===(a=o[0])||void 0===a?void 0:a.innerText),r.labelText=null===(i=o[0])||void 0===i?void 0:i.innerText,e instanceof HTMLSelectElement||(r.inputPlaceholder=""==e.placeholder?void 0:e.placeholder),r.inputRequired=e.required,r},n.analyzeForm=e=>{},n.analyzeField=e=>{const n=c(),t=(0,r.matchByLabel)(e);console.log(t),l(n,t,o.default.matchBy.Label);const a=(0,r.matchByPlaceholder)(e);console.log(a),l(n,a,o.default.matchBy.Placeholder);const i=(0,r.matchByFieldType)(e);console.log(i),l(n,i,o.default.matchBy.FieldType);const d=(0,r.matchByInputType)(e);console.log(d),l(n,d,o.default.matchBy.InputType);const u=(0,r.matchByFormType)(e);console.log(u),l(n,u,o.default.matchBy.FormType);const m=s(n).sort(((e,n)=>n.confidenceScore-e.confidenceScore));return console.log(m),m},n.getNameOfAcId=e=>-1===Object.keys(i.default.byId).indexOf(e)?"!ERROR!":i.default.byId[e],n.getIdOfAcName=e=>{const n=Object.entries(i.default.byId).map((([e,n])=>n)).indexOf(e);return-1===n?"!ERROR!":Object.keys(i.default.byId)[n]};const c=()=>{const e=[];for(const n of Object.keys(i.default.byId))e.push({classId:n,resultsAndWeights:[]});return e},l=(e,n,t)=>{const a=[...n];for(const e of Object.keys(i.default.byId))n.find((n=>n.id===e))||a.push({id:e,confidence:0});for(const n of a){const a=e.findIndex((e=>e.classId==n.id)),i={result:n.confidence,weight:t};-1===a?e.push({classId:n.id,resultsAndWeights:[i]}):e[a].resultsAndWeights.push(i)}},s=e=>{const t=[];for(const a of e){const e=a.resultsAndWeights.reduce(((e,n)=>e+n.result*n.weight),0)/a.resultsAndWeights.reduce(((e,n)=>e+n.weight),0);t.push({acValue:(0,n.getNameOfAcId)(a.classId),acId:a.classId,confidenceScore:e})}return t},d=(e,n)=>{const t=[];if(void 0===n)return t;const a=e.getElementById(n);if(null===a)return t;const i=["h1","h2","h3","h4","h5","h6"];for(const e of i){const n=a.getElementsByTagName(e);for(const e of n)""!==e.innerHTML&&t.push(e.innerHTML)}return t}},579:function(e,n,t){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.matchByFormType=n.matchByInputType=n.matchByFieldType=n.matchByPlaceholder=n.matchByLabel=void 0;const i=t(574),r=a(t(37)),o=a(t(643));n.matchByLabel=e=>{const n=[];if(void 0===e.labelText)return n;const t=r.default.byLabel_EN;for(const a of Object.keys(t)){const i=l(t[a],e.labelText);["full","partial"].includes(i)&&n.push({id:a,confidence:1*o.default.labelSubstringSearch[i]})}const a=r.default.byLabel_DE;for(const t of Object.keys(a)){const i=l(a[t],e.labelText);if(["full","partial"].includes(i)){const e=n.findIndex((e=>e.id==t));-1===e?n.push({id:t,confidence:1*o.default.labelSubstringSearch[i]}):n[e].confidence=(n[e].confidence+1*o.default.labelSubstringSearch[i])/2}}return c(n)},n.matchByPlaceholder=e=>{const n=[];if(void 0===e.inputPlaceholder)return n;const t=r.default.byLabel_EN;for(const a of Object.keys(t)){const i=l(t[a],e.inputPlaceholder);["full","partial"].includes(i)&&n.push({id:a,confidence:1*o.default.labelSubstringSearch[i]})}const a=r.default.byLabel_DE;for(const t of Object.keys(a)){const i=l(a[t],e.inputPlaceholder);if(["full","partial"].includes(i)){const e=n.findIndex((e=>e.id==t));-1===e?n.push({id:t,confidence:1*o.default.labelSubstringSearch[i]}):n[e].confidence=(n[e].confidence+1*o.default.labelSubstringSearch[i])/2}}return c(n)},n.matchByFieldType=e=>{const n=[];if(void 0===e.fieldType)return n;const t=r.default.byFieldType;if(Object.keys(t).includes(e.fieldType))for(const a of t[e.fieldType]){let i=.75;t[e.fieldType].length<30&&(i=1),n.push({id:`${a}`,confidence:i})}return c(n)},n.matchByInputType=e=>{const n=[];if("input"!==e.fieldType||void 0===e.inputType)return n;const t=r.default.byInputType;if(Object.keys(t).includes(e.inputType))for(const a of t[e.inputType]){let i=.5;t[e.inputType].length<5?i=1:t[e.inputType].length>30&&(i=.75),n.push({id:`${a}`,confidence:i})}return c(n)},n.matchByFormType=e=>{const n=[];if(void 0===e.formId)return n;if(void 0===e.formHeadings||0===e.formHeadings.length)return n;const t={login:{full:0,partial:0,none:0},signup:{full:0,partial:0,none:0}};for(const n of e.formHeadings){const e=r.default.byFormType_EN;for(const a of Object.keys(e)){const i=l(e[a],n);"login"===a&&(t.login[i]=t.login[i]+1),"signup"===a&&(t.signup[i]=t.signup[i]+1)}const a=r.default.byFormType_DE;for(const e of Object.keys(a)){const i=l(a[e],n);"login"===e&&(t.login[i]=t.login[i]+1),"signup"===e&&(t.signup[i]=t.signup[i]+1)}}const a=2*t.login.full+t.login.partial,o=2*t.signup.full+t.signup.partial,s=(0,i.getIdOfAcName)("new-password"),d=(0,i.getIdOfAcName)("current-password");return console.log(s,d),a<o?(n.push({id:`${s}`,confidence:1}),n.push({id:`${d}`,confidence:.5})):(n.push({id:`${s}`,confidence:.5}),n.push({id:`${d}`,confidence:1})),c(n)};const c=e=>{const n=e.reduce(((e,n)=>e+n.confidence),0)/e.length;return e.map((e=>({id:e.id,confidence:e.confidence*n}))),e},l=(e,n)=>{if(e.map((e=>s(e))).includes(s(n)))return"full";const t=n.split(/\s+/).filter(Boolean);for(const n of t)if(e.some((e=>-1!==s(e).indexOf(s(n)))))return"partial";return"none"},s=e=>e.replace(" ","").replace(/\W/g,"").toLowerCase()},870:function(e,n,t){var a=this&&this.__awaiter||function(e,n,t,a){return new(t||(t=Promise))((function(i,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function c(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,c)}l((a=a.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0});const i=t(574);chrome.runtime.onInstalled.addListener((()=>a(void 0,void 0,void 0,(function*(){chrome.action.setBadgeText({text:"OFF"}),yield chrome.storage.local.set({"acc.highlight":!1}),yield chrome.storage.local.set({"acc.showHidden":!0}),yield chrome.storage.local.set({"acc.devMode":!1})})))),chrome.runtime.onMessage.addListener(((e,n,t)=>a(void 0,void 0,void 0,(function*(){switch(e.msg){case"acc.updateBadgeText":t({status:a(void 0,void 0,void 0,(function*(){const e=(yield chrome.storage.local.get(["acc.highlight"]))["acc.highlight"];return chrome.action.setBadgeText({text:e?"ON":"OFF"}),!0}))});break;case"acc.addFormToDB":t({status:o(e.url,e.data)});break;case"acc.classifyField":t({data:r(e.data)})}return!0}))));const r=e=>(0,i.analyzeField)(e),o=(e,n)=>a(void 0,void 0,void 0,(function*(){console.log("begin ");const t=yield fetch("http://192.168.178.100:5987/formfieldcheck-db/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("admin:password")},body:JSON.stringify({url:e,inputs:n})});return console.log(t.statusText),console.log(t),!0}))},37:e=>{e.exports=JSON.parse('{"byId":{"1":"name","2":"honorific-prefix","3":"given-name","4":"additional-name","5":"family-name","6":"honorific-suffix","7":"nickname","8":"organization-title","9":"username","10":"new-password","11":"current-password","12":"organization","13":"street-address","14":"address-line1","15":"address-line2","16":"address-line3","17":"address-level4","18":"address-level3","19":"address-level2","20":"address-level1","21":"country","22":"country-name","23":"postal-code","24":"cc-name","25":"cc-given-name","26":"cc-additional-name","27":"cc-family-name","28":"cc-number","29":"cc-exp","30":"cc-exp-month","31":"cc-exp-year","32":"cc-csc","33":"cc-type","34":"transaction-currency","35":"transaction-amount","36":"language","37":"bday","38":"bday-day","39":"bday-month","40":"bday-year","41":"sex","42":"url","43":"photo","44":"tel","45":"tel-country-code","46":"tel-national","47":"tel-area-code","48":"tel-local","49":"tel-local-prefix","50":"tel-local-suffix","51":"tel-extension","52":"email","53":"impp"},"byInputType":{"button":[],"checkbox":[2,6,33,34,36,41,45],"color":[],"date":[37],"datetime-local":[],"email":[9,52],"file":[],"hidden":[],"image":[],"month":[29],"number":[23,28,29,30,31,32,35,38,39,40,44,45,46,47,48,49,50,51],"password":[10,11],"radio":[],"range":[35],"reset":[],"search":[],"submit":[],"tel":[44],"text":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53],"time":[],"url":[42,43,53],"week":[],"datetime":[]},"byFieldType":{"input":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53],"textarea":[13,42,43,44],"select":[2,6,8,21,22,33,34,36,38,39,40,41,45]},"byLabel_EN":{"1":["name","fullname"],"2":["honorificprefix","honorific","prefix"],"3":["givenname","firstname","forename","callname"],"4":["additionalname","middlename"],"5":["familyname","lastname","surname"],"6":["honorificsuffix","honorific","suffix"],"7":["nickname","nick","screenname","alias"],"8":["organizationtitle","jobtitle","title"],"9":["username"],"10":["newpassword"],"11":["currentpassword","password"],"12":["organization","company","companyname"],"13":["streetaddress","address"],"14":["streetaddress","address","line1"],"15":["streetaddress","address","line2"],"16":["streetaddress","address","line3"],"17":["level4","address","town","city"],"18":["level3","address","district"],"19":["level2","address","town","city"],"20":["level1","address","state","town","province, prefecture"],"21":["country","countrycode"],"22":["country","countryname"],"23":["postalcode","zip","zipcode","postcode","cedex"],"24":["ccname","creditcardname","name","nameoncard"],"25":["ccgivenname","creditcardgivenname","givenname","creditcardfirstname","creditcardforename","creditcardcallname","firstname","forename","callname"],"26":["ccadditionalname","ccmiddlename","creditcardadditionbalname","creditcardmiddlename"],"27":["ccfamilyname","cclastname","ccsurname","creditcardfamilyname","creditcardlastname","creditcardsurname"],"28":["ccnumber","creditcardnumber","cardnumber","cardno"],"29":["expirationdate","expires","expiration"],"30":["expirationmonth","expiresmonth"],"31":["expirationyear","expiresyear"],"32":["securitycode","security","csc","cardsecuritycode","cvc","cardvalidationcode","cvv","cardverificationvalue","spc","signaturepanelcode","ccid","creditcardid"],"33":["payment","paymentprovider","provider","visa","mastercard","paypal"],"34":["transactioncurrency","currency","eur","usd","gbp","chf"],"35":["transactionamount","amount"],"36":["language"],"37":["birthday","bday"],"38":["birthdayday, bdayday","day"],"39":["birthdaymonth","bdaymonth","birthmonth","month"],"40":["birthyear","bdayyear","birthdayyear"],"41":["sex","gender","genderidentity","identity","male","female","transgender","trans","queer","other"],"42":["url","link","homepage","webpage","site","website"],"43":["photo","photograph","icon","image"],"44":["tel","telephone","telephonenumber","mobile","mobilephone"],"45":["countrycode"],"46":["telnational"],"47":["telareacode","areacode","area"],"48":["tellocal","local"],"49":["tellocalprefix","localprefix"],"50":["tellocalsuffix","localsuffix"],"51":["telextension","internalextension","extension","internal"],"52":["email","emil","emailaddress"],"53":["impp","instantmessagingprotocol","instantmessagingprotocolendpoint"]},"byLabel_DE":{"1":["name","vorundnachname"],"2":["anrede","titel","prefix"],"3":["vorname","rufname"],"4":["zweitname","zwischenname","mittelname"],"5":["nachname","familienname"],"6":["namenszusatz","zusatz","suffix"],"7":["alias","künstlername","spitzname"],"8":["beruf","titel","jobbezeichnung"],"9":["benutzername"],"10":["neuespasswort"],"11":["aktuellespasswort","passwort"],"12":["organisation","firma","betrieb","konzern","geschäft"],"13":["adresse"],"14":["adresszeile1","zeile1"],"15":["adresszeile2","zeile2"],"16":["adresszeile3","zeile3"],"17":["level4"],"18":["level3","stadtteil"],"19":["level2","stadt","dorf"],"20":["level1","bundesland","kanton"],"21":["ländercode","code"],"22":["ländername","landname","land"],"23":["postleitzahl","plz"],"24":["kreditkartenname","name","namedeskarteninhabers"],"25":["kreditkartenvorname","vorname"],"26":["kreditkartenzweitname","kreditkartenzwischenname","kreditkartenmittelname","zweitname","zwischenname","mittelname"],"27":["kreditkartennachname"],"28":["kreditkartennummer","iban","kartennummer"],"29":["verfallsdatum","läuftab","gültig"],"30":["ablaufmonat"],"31":["ablaufjahr"],"32":["sicherheitscode","csc","cvc","cvv","spc","ccid"],"33":["zahlungsmethode","zahlungsanbieter","anbieter","visa","mastercard","paypal"],"34":["währung","transaktionswährung","eur","usd","gbp","chf"],"35":["transaktionsbetrag","betrag"],"36":["sprache"],"37":["geburtstag"],"38":["geburtstagtag","tag"],"39":["geburtstagmonat","monat"],"40":["geburtsjahr"],"41":["geschlecht","gender","geschlechtsidentität","identität","mann","frau","divers","transgender","trans","queer","other"],"42":["url","link","homepage","webseite","seite"],"43":["foto","bild","icon"],"44":["tel","telefon","telefonnummer","handy","mobiltelefon","mobilnummer"],"45":["ländervorwahl","vorwahldeslandes","vorwahldeslands"],"46":["nationaletelefonnummer"],"47":["vorwahl"],"48":[],"49":[],"50":[],"51":["durchwahl","internenummer","intern"],"52":["email","emil","emailadresse"],"53":["impp","instantmessagingprotocol","instantmessagingprotocolendpoint"]},"byFormType_EN":{"login":["login","signin"],"signup":["create","signup","register","registration","new","newaccount"]},"byFormType_DE":{"login":["login","anmelden","einloggen"],"signup":["erstellen","neuanmelden","neu","registrieren","registrierung"]}}')},643:e=>{e.exports=JSON.parse('{"matchBy":{"Label":5,"Placeholder":4,"FieldType":1,"InputType":1,"FormType":2},"labelSubstringSearch":{"full":1,"partial":0.8,"none":0}}')}},n={};!function t(a){var i=n[a];if(void 0!==i)return i.exports;var r=n[a]={exports:{}};return e[a].call(r.exports,r,r.exports,t),r.exports}(870)})();